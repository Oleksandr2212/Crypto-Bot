#!/bin/bash
set -e

echo "üßπ –í–∏–¥–∞–ª—è—é —Å—Ç–∞—Ä—É –≤–µ—Ä—Å—ñ—é Python 3.14..."
sudo rm -rf /Library/Frameworks/Python.framework/Versions/3.14
sudo rm -f /usr/local/bin/python3.14
sudo rm -f /usr/local/bin/pip3.14
echo "‚úÖ Python 3.14 –≤–∏–¥–∞–ª–µ–Ω–æ."

# --- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó Python —á–µ—Ä–µ–∑ Homebrew ---
echo "üêç –í—Å—Ç–∞–Ω–æ–≤–ª—é—é Python 3.11 (—Å—É–º—ñ—Å–Ω–∏–π –∑ aiogram 2.25.1)..."
brew install python@3.11

# --- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è alias ---
echo "üîß –ù–∞–ª–∞—à—Ç–æ–≤—É—é python3 –Ω–∞ Python 3.11..."
brew link --overwrite python@3.11
export PATH="/usr/local/opt/python@3.11/bin:$PATH"

# --- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–µ—Ä—Å—ñ—ó ---
python3 --version

# --- –ü–µ—Ä–µ—Ö—ñ–¥ —É –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç—É ---
cd ~/Desktop/CryptoBot || { echo "‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–∞–ø–∫—É CryptoBot"; exit 1; }

# --- –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ ---
rm -rf venv

# --- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ ---
echo "‚öôÔ∏è –°—Ç–≤–æ—Ä—é—é –Ω–æ–≤–µ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ..."
python3 -m venv venv

# --- –ê–∫—Ç–∏–≤—É—é —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ ---
source venv/bin/activate

# --- –û–Ω–æ–≤–ª—é—é pip ---
echo "‚¨ÜÔ∏è –û–Ω–æ–≤–ª—é—é pip..."
pip install --upgrade pip

# --- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π ---
echo "üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞–∫–µ—Ç–∏..."
pip install aiogram==2.25.1 flask python-dotenv

echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"
echo "üåü –í—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ."
echo "–¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ—é: python bot.py"

